function inicializarTabla(){$(".adv-table").footable({sorting:{enabled:!1},paging:{enabled:!0,current:1},strings:{enabled:!1},filtering:{enabled:!1}})}function cargarFormulario(){$("#body-modal").load(_urlFormularioDetEntrada,null,onFormularioCompleted)}function onFormularioCompleted(e,o,t){$("#observaciones").trumbowyg({svgPath:"../img/svg/icons.svg",btns:[["formatting"],["strong","em","del"],["superscript","subscript"],["link"],["base64"],["justifyLeft","justifyCenter","justifyRight","justifyFull"],["unorderedList","orderedList"],["emoji"]]})}function submitReporteForm(e){e.preventDefault();const o=`/reportes/${folioReporte}/entrada`,t="POST",i=$(e.target);$("span.text-danger").text(""),$.ajax({url:o,type:t,data:i.serialize(),success:function(e){modal.hide(),Swal.fire({title:"Entrada registrada",icon:"success",confirmButtonText:"Aceptar"}).then(e=>{window.location.reload()})},error:function(e,o,t){if(console.error(e,t),422==e.status){const{errors:o}=e.responseJSON;o.forEach(e=>{const o=$(`span[data-valmsg-for="${e.field}"]`);o.text(e.message)})}else{let o="Error no controlado al registrar la entrada";if(e.responseJSON){const{title:t}=e.responseJSON;t&&(o=t)}Swal.fire({title:o,icon:"error"})}}})}function mostrarDocumento(e,o,t){$("body").css("cursor","wait");const i=$("#body-modal2 iframe");i.off("load"),i.on("load",function(){$("body").css("cursor","default"),$("#modaltitle2").text(o),modalDocumento.show()}),i.attr("src",t)}let modal=void 0,modalDocumento=void 0;var modificacionReporte={selectTipoReporte:void 0,selectEstatus:void 0,buttonSave:void 0,buttonDiscard:void 0,currentEstatus:void 0,currentTipoReporte:void 0,showSaveChangesButton:!1,_newEstatus:void 0,_newTipoReporte:void 0,set newEstatus(e){this._newEstatus=e,this.checkChanges()},get newEstatus(){return this._newEstatus},set newTipoReporte(e){this._newTipoReporte=e,this.checkChanges()},get newTipoReporte(){return this._newTipoReporte},load:()=>{modificacionReporte.currentEstatus=_currentEstatus,modificacionReporte.currentTipoReporte=_currentTipoReporte,modificacionReporte._newEstatus=_currentEstatus,modificacionReporte._newTipoReporte=_currentTipoReporte,modificacionReporte.buttonSave=document.getElementById("button-save-changes"),modificacionReporte.buttonSave.addEventListener("click",function(e){modificacionReporte.saveChanges()}),modificacionReporte.buttonDiscard=document.getElementById("button-discard-changes"),modificacionReporte.buttonDiscard.addEventListener("click",function(e){modificacionReporte.discardChanges()}),modificacionReporte.selectTipoReporte=document.getElementById("select-tiporeporte"),modificacionReporte.selectTipoReporte.value=modificacionReporte.newTipoReporte,modificacionReporte.selectTipoReporte.addEventListener("change",function(e){const o=e.target.value;o!==modificacionReporte.newTipoReporte&&(modificacionReporte.newTipoReporte=o)}),modificacionReporte.selectEstatus=document.getElementById("select-estatus"),modificacionReporte.selectEstatus.value=modificacionReporte.newEstatus,modificacionReporte.selectEstatus.addEventListener("change",function(e){const o=e.target.value;o!==modificacionReporte.newEstatus&&(modificacionReporte.newEstatus=o)})},checkChanges:()=>{modificacionReporte.currentEstatus!=modificacionReporte._newEstatus||modificacionReporte.currentTipoReporte!=modificacionReporte._newTipoReporte?(modificacionReporte.showSaveChangesButton=!0,modificacionReporte.buttonDiscard.classList.remove("d-none"),modificacionReporte.buttonSave.classList.remove("d-none")):(modificacionReporte.showSaveChangesButton=!1,modificacionReporte.buttonDiscard.classList.add("d-none"),modificacionReporte.buttonSave.classList.add("d-none"))},discardChanges:()=>{modificacionReporte._newEstatus=modificacionReporte.currentEstatus,modificacionReporte._newTipoReporte=modificacionReporte.currentTipoReporte,modificacionReporte.selectEstatus.value=modificacionReporte._newEstatus,modificacionReporte.selectTipoReporte.value=modificacionReporte._newTipoReporte,modificacionReporte.checkChanges()},saveChanges:()=>{const e={EstatusId:modificacionReporte.newEstatus,TipoReporte:modificacionReporte.newTipoReporte};$.ajax({url:`/api/reportes/${folioReporte}`,type:"PATCH",data:e,success:function(e){Swal.fire({title:"Reporte actualizado",icon:"success",confirmButtonText:"Aceptar"}).then(()=>{window.location.reload()})},error:function(e){let o="Error al actualizar el reporte";e.responseJSON&&e.responseJSON.title&&(o=e.responseJSON.title),Swal.fire({title:o,icon:"error"})}})}},maps={map:void 0,default_lat:19.922385,default_lon:-96.826112,init:(e,o)=>{let t=!1;if(e&&o){t=!0;var i=new google.maps.LatLng(e,o),a=17}else i=new google.maps.LatLng(maps.default_lat,maps.default_lon),a=7;i=e&&o?new google.maps.LatLng(e,o):new google.maps.LatLng(maps.default_lat,maps.default_lon);var n={center:i,zoom:a,scrollwheel:!1,mapId:"eticket_reporte_map_id"};if(maps.map=new google.maps.Map(document.getElementById("google-map"),n),t){const e=new google.maps.marker.AdvancedMarkerElement({map:maps.map,position:i,title:"Uluru"});e.setMap(maps.map)}}};jQuery(document).ready(function(){document.getElementsByClassName("nueva-entrada-modal").length&&(modal=new bootstrap.Modal(document.getElementById("nueva-entrada-modal"))),document.getElementsByClassName("documento-adjunto-modal").length&&(modalDocumento=new bootstrap.Modal(document.getElementById("documento-adjunto-modal"))),cargarFormulario(),inicializarTabla(),modificacionReporte.load(),$("#google-map").length&&maps.init(_lat,_lon)});